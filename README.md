# aplikasi-ehem
gunakan sebijak mungkin yaaah
import React, { useState, useEffect, useRef } from "react";

// Generator RPM IIF SADEWA GOA
// Single-file React component. Tailwind CSS assumed present in the project.
// How to use: Insert into a React app (e.g., Vite or Create React App) and ensure Tailwind is configured.

export default function GeneratorRPM() {
  // --- Auth / tokens ---
  const ADMIN_USERNAME = "IIF SADEWA GOA"; // known but not displayed anywhere in UI
  const ADMIN_PASSWORD = "29021996"; // known but not shown

  const [user, setUser] = useState(null); // {role: 'admin'|'participant', name}
  const [loginError, setLoginError] = useState("");
  const [tokenInput, setTokenInput] = useState("");

  // tokens stored in localStorage under key 'rpm_tokens' as array of {token, label, createdAt}
  const loadTokens = () => {
    try {
      const raw = localStorage.getItem("rpm_tokens");
      return raw ? JSON.parse(raw) : [];
    } catch (e) {
      return [];
    }
  };
  const [tokens, setTokens] = useState(loadTokens());

  useEffect(() => {
    localStorage.setItem("rpm_tokens", JSON.stringify(tokens));
  }, [tokens]);

  const makeToken = (label = "peserta") => {
    const t = Math.random().toString(36).slice(2, 10).toUpperCase();
    const item = { token: t, label, createdAt: new Date().toISOString() };
    setTokens((s) => [item, ...s]);
    return item;
  };

  const revokeToken = (token) => {
    setTokens((s) => s.filter((x) => x.token !== token));
  };

  // --- Form inputs required by user ---
  const initialForm = {
    namaSatuan: "",
    namaGuru: "",
    nipGuru: "",
    namaKepala: "",
    nipKepala: "",
    jenjang: "SD",
    kelas: "",
    mapel: "",
    capaianPembelajaran: "",
    tujuanPembelajaran: "",
    materiPelajaran: "",
    jumlahPertemuan: 1,
    durasiPertemuan: "2 × 35 menit",
    praktikPerPertemuan: [], // array length = jumlahPertemuan of choices
    dimensiLulusan: [],
  };

  const [form, setForm] = useState(initialForm);

  // generate praktikPerPertemuan default if jumlahPertemuan changes
  useEffect(() => {
    const n = Number(form.jumlahPertemuan) || 1;
    setForm((f) => {
      const arr = Array.from({ length: n }, (_, i) => f.praktikPerPertemuan[i] || "Inkuiri-Discovery");
      return { ...f, praktikPerPertemuan: arr };
    });
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [form.jumlahPertemuan]);

  // --- Validation ---
  const validate = () => {
    const req = [
      { k: "namaSatuan", t: "Nama Satuan Pendidikan" },
      { k: "namaGuru", t: "Nama Guru" },
      { k: "nipGuru", t: "NIP Guru" },
      { k: "namaKepala", t: "Nama Kepala Sekolah" },
      { k: "nipKepala", t: "NIP Kepala Sekolah" },
      { k: "kelas", t: "Kelas" },
      { k: "mapel", t: "Mata Pelajaran" },
      { k: "capaianPembelajaran", t: "Capaian Pembelajaran (CP)" },
      { k: "tujuanPembelajaran", t: "Tujuan Pembelajaran" },
      { k: "materiPelajaran", t: "Materi Pelajaran" },
    ];
    const missing = req.filter((r) => !form[r.k] || String(form[r.k]).trim() === "");
    if (missing.length) return `${missing.map((m) => m.t).join(", ")} wajib diisi.`;
    if (!Number(form.jumlahPertemuan) || Number(form.jumlahPertemuan) < 1)
      return "Jumlah Pertemuan harus berupa angka minimal 1.";
    if (!form.dimensiLulusan.length) return "Pilih minimal satu Dimensi Lulusan.";
    return "";
  };

  // --- Generation logic ---
  const generateStudents = (kelas) => {
    // simple autogenerated summary
    return `Kelas ${kelas} (jumlah sekitar 30 siswa, beragam kemampuan: rendah, sedang, tinggi).`;
  };

  const generateLintasDisiplin = (mapel) => {
    const map = {
      Matematika: ["Fisika dasar", "Statistika dasar", "Pengembangan pola"],
      Bahasa: ["Sastra", "Sejarah", "Pendidikan kewargaan"],
      IPA: ["Biologi", "Kimia", "Lingkungan hidup"],
    };
    const base = map[mapel] || ["Keterampilan berpikir kritis", "Literasi digital", "Kewargaan"];
    return base.join(", ");
  };

  const generateKemitraan = (mapel) => {
    return `Kerja sama dengan: Perpustakaan sekolah, Dinas Pendidikan setempat, (jika relevan) institusi/komunitas terkait ${mapel}.`;
  };

  const generateLingkungan = (mapel) => {
    return `Lingkungan: ruang kelas fleksibel, laboratorium (jika relevan), lingkungan luar untuk observasi, sumber belajar digital.`;
  };

  const generatePemanfaatanDigital = (mapel) => {
    // suggest a few tools
    const suggestions = [
      { name: "Google Docs", use: "dokumen kolaboratif dan penilaian" },
      { name: "Google Classroom / Microsoft Teams", use: "distribusi tugas dan komunikasi" },
      { name: "Kahoot!", use: "kuis interaktif" },
      { name: "Padlet", use: "papan kolaboratif" },
      { name: "Canva", use: "pembuatan poster/visual" },
    ];
    return suggestions.map((s) => `${s.name} (${s.use})`).join("; ");
  };

  const deriveTopik = (materi) => {
    // crude splitting into topics by sentences or commas
    const parts = materi.split(/[.\n,;]+/).map((p) => p.trim()).filter(Boolean);
    if (parts.length <= 3) return parts.join("; ");
    return parts.slice(0, 4).join("; ");
  };

  const generateRPM = () => {
    const err = validate();
    if (err) return { error: err };

    const identitas = {
      namaSatuan: form.namaSatuan,
      mataPelajaran: form.mapel,
      kelasSemester: `${form.kelas} / Semester 1`,
      durasiPertemuan: `${form.jumlahPertemuan} x ${form.durasiPertemuan}`,
    };

    const identifikasi = {
      siswa: generateStudents(form.kelas),
      materiPelajaran: form.materiPelajaran,
      capaianDimensiLulusan: form.dimensiLulusan.join(", "),
    };

    const desain = {
      capaianPembelajaran: form.capaianPembelajaran,
      lintasDisiplin: generateLintasDisiplin(form.mapel),
      tujuanPembelajaran: form.tujuanPembelajaran,
      topikPembelajaran: deriveTopik(form.materiPelajaran),
      praktikPerPertemuan: form.praktikPerPertemuan,
      kemitraan: generateKemitraan(form.mapel),
      lingkungan: generateLingkungan(form.mapel),
      pemanfaatanDigital: generatePemanfaatanDigital(form.mapel),
    };

    // pengalaman belajar: create for each meeting steps based on praktik
    const pengalamanBelajar = form.praktikPerPertemuan.map((praktik, idx) => {
      const nomor = idx + 1;
      // choose style words based on praktik
      const memahami = `Memahami secara bermakna melalui kegiatan apersepsi dan pengaktifan pengetahuan awal pada pertemuan ${nomor}.`;
      const mengaplikasi = `Mengaplikasi melalui ${praktik} pada kegiatan inti (sintaks: orientasi, eksplorasi, elaborasi, konfirmasi).`;
      const refleksi = `Refleksi dilakukan di penutup: ringkasan, umpan balik, dan tugas lanjutan.`;
      return { pertemuan: nomor, memahami, mengaplikasi, refleksi };
    });

    const asesmen = {
      asesmenAwal: "Pertanyaan apersepsi singkat dan cek prasyarat; diagnostik singkat untuk mengetahui kemampuan awal siswa.",
      asesmenProses: "Observasi, rubrik penilaian kolaborasi, catatan anekdot, dan diskusi terarah selama proses pembelajaran.",
      asesmenAkhir: "Produk tugas, presentasi kelompok / individu, dan portofolio pembelajaran.",
    };

    return { identitas, identifikasi, desain, pengalamanBelajar, asesmen };
  };

  const [generated, setGenerated] = useState(null);

  // Refs for copy
  const outputRef = useRef();

  const handleGenerate = (e) => {
    e?.preventDefault();
    const res = generateRPM();
    if (res.error) {
      alert(res.error);
      return;
    }
    setGenerated(res);
    // scroll to output
    setTimeout(() => {
      outputRef.current?.scrollIntoView({ behavior: "smooth" });
    }, 100);
  };

  // Copy & open Google Docs
  const copyAsHtmlToClipboard = async () => {
    if (!outputRef.current) return;
    const html = outputRef.current.innerHTML;
    const plain = outputRef.current.innerText;
    try {
      // modern clipboard API with text/html
      const blobHtml = new Blob([html], { type: "text/html" });
      const blobText = new Blob([plain], { type: "text/plain" });
      // @ts-ignore
      await navigator.clipboard.write([new ClipboardItem({ "text/html": blobHtml, "text/plain": blobText })]);
      return true;
    } catch (e) {
      try {
        await navigator.clipboard.writeText(plain);
        return true;
      } catch (e2) {
        console.error(e2);
        return false;
      }
    }
  };

  const handleCopyAndOpenDocs = async () => {
    const ok = await copyAsHtmlToClipboard();
    if (!ok) return alert("Gagal menyalin. Silakan salin secara manual dari layar.");
    // open Google Docs in new tab; user must paste (browser security prevents auto-paste)
    window.open("https://docs.google.com/document/create", "_blank");
  };

  const handlePrintPdf = () => {
    window.print();
  };

  // --- Small helper components ---
  const PraktikOptions = ["Inkuiri-Discovery", "PjBL", "Problem Solving", "Game Based Learning", "Station Learning"];

  // --- Login handlers ---
  const handleAdminLogin = (username, password) => {
    if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
      setUser({ role: "admin", name: "Admin IIF SADEWA GOA" });
      setLoginError("");
    } else {
      setLoginError("Username atau password admin salah.");
    }
  };

  const handleParticipantLogin = (token) => {
    const ok = tokens.find((t) => t.token === token);
    if (ok) {
      setUser({ role: "participant", name: `Peserta (${ok.label})` });
      setLoginError("");
    } else {
      setLoginError("Token tidak valid. Minta token dari admin.");
    }
  };

  // --- UI ---
  if (!user) {
    return (
      <div className="min-h-screen bg-gray-50 p-6 flex items-center justify-center">
        <div className="max-w-3xl w-full bg-white shadow-md rounded-2xl p-6">
          <h1 className="text-2xl font-bold mb-4">Generator RPM — IIF SADEWA GOA</h1>
          <p className="mb-4">Silakan masuk: <span className="font-semibold">Admin</span> atau <span className="font-semibold">Peserta</span>.</p>

          <div className="grid md:grid-cols-2 gap-4">
            <div className="p-4 border rounded">
              <h2 className="font-semibold mb-2">Masuk sebagai Admin</h2>
              <p className="text-sm mb-2">(masukkan kredensial admin)</p>
              <AdminLoginForm onLogin={handleAdminLogin} />
            </div>

            <div className="p-4 border rounded">
              <h2 className="font-semibold mb-2">Masuk sebagai Peserta</h2>
              <p className="text-sm mb-2">Masukkan token yang dibuat oleh admin.</p>
              <div className="flex gap-2">
                <input value={tokenInput} onChange={(e) => setTokenInput(e.target.value)} placeholder="TOKEN" className="flex-1 p-2 border rounded" />
                <button onClick={() => handleParticipantLogin(tokenInput.trim())} className="px-4 py-2 bg-blue-600 text-white rounded">Masuk</button>
              </div>
            </div>
          </div>

          {loginError && <p className="mt-4 text-red-600">{loginError}</p>}

          <p className="mt-6 text-sm text-gray-600">Catatan: kredensial admin sudah ditetapkan (tidak ditampilkan di muka). Admin dapat membuat token peserta.</p>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gray-100 p-6">
      <div className="max-w-7xl mx-auto">
        <header className="flex items-center justify-between mb-6">
          <h1 className="text-2xl font-bold">Generator RPM IIF SADEWA GOA</h1>
          <div className="flex items-center gap-4">
            <div className="text-sm">{user.name} ({user.role})</div>
            <button onClick={() => { setUser(null); setGenerated(null); }} className="px-3 py-1 border rounded">Keluar</button>
          </div>
        </header>

        <main className="grid md:grid-cols-3 gap-6">
          <section className="md:col-span-1 bg-white p-4 rounded shadow">
            <h2 className="font-semibold mb-2">Form Input (Wajib diisi)</h2>
            <form onSubmit={handleGenerate} className="space-y-3">
              <Input label="Nama Satuan Pendidikan" value={form.namaSatuan} onChange={(v) => setForm({ ...form, namaSatuan: v })} required />
              <Input label="Nama Guru" value={form.namaGuru} onChange={(v) => setForm({ ...form, namaGuru: v })} required />
              <Input label="NIP Guru" value={form.nipGuru} onChange={(v) => setForm({ ...form, nipGuru: v })} required />
              <Input label="Nama Kepala Sekolah" value={form.namaKepala} onChange={(v) => setForm({ ...form, namaKepala: v })} required />
              <Input label="NIP Kepala Sekolah" value={form.nipKepala} onChange={(v) => setForm({ ...form, nipKepala: v })} required />

              <div>
                <label className="block text-sm font-medium">Jenjang Pendidikan</label>
                <select className="w-full p-2 border rounded mt-1" value={form.jenjang} onChange={(e) => setForm({ ...form, jenjang: e.target.value })}>
                  <option>SD</option>
                  <option>SMP</option>
                  <option>SMA</option>
                </select>
              </div>

              <Input label="Kelas (sesuai jenjang)" value={form.kelas} onChange={(v) => setForm({ ...form, kelas: v })} required />
              <Input label="Mata Pelajaran" value={form.mapel} onChange={(v) => setForm({ ...form, mapel: v })} required />
              <Textarea label="Capaian Pembelajaran (CP)" value={form.capaianPembelajaran} onChange={(v) => setForm({ ...form, capaianPembelajaran: v })} required />
              <Textarea label="Tujuan Pembelajaran" value={form.tujuanPembelajaran} onChange={(v) => setForm({ ...form, tujuanPembelajaran: v })} required />
              <Textarea label="Materi Pelajaran" value={form.materiPelajaran} onChange={(v) => setForm({ ...form, materiPelajaran: v })} required />

              <div className="grid grid-cols-2 gap-2">
                <Input label="Jumlah Pertemuan" type="number" value={form.jumlahPertemuan} onChange={(v) => setForm({ ...form, jumlahPertemuan: Number(v) })} required />
                <Input label="Durasi Setiap Pertemuan" value={form.durasiPertemuan} onChange={(v) => setForm({ ...form, durasiPertemuan: v })} required />
              </div>

              <div>
                <label className="block text-sm font-medium">Praktik Pedagogis per Pertemuan</label>
                <div className="text-xs text-gray-600 mb-1">Pilih untuk setiap pertemuan (default: Inkuiri-Discovery)</div>
                <div className="space-y-2 max-h-48 overflow-auto p-2 border rounded">
                  {form.praktikPerPertemuan.map((p, i) => (
                    <div key={i} className="flex gap-2 items-center">
                      <div className="w-6 text-sm">{i + 1}.</div>
                      <select className="flex-1 p-1 border rounded" value={p} onChange={(e) => setForm((f) => { const copy = [...f.praktikPerPertemuan]; copy[i] = e.target.value; return { ...f, praktikPerPertemuan: copy }; })}>
                        {PraktikOptions.map((o) => <option key={o}>{o}</option>)}
                      </select>
                    </div>
                  ))}
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium">Dimensi Lulusan (pilih minimal satu)</label>
                <div className="grid grid-cols-2 gap-1 mt-2">
                  {[
                    "Keimanan & Ketakwaan",
                    "Kewargaan",
                    "Penalaran Kritis",
                    "Kreativitas",
                    "Kolaborasi",
                    "Kemandirian",
                    "Kesehatan",
                    "Komunikasi",
                  ].map((d) => (
                    <label key={d} className="text-sm">
                      <input type="checkbox" className="mr-2" checked={form.dimensiLulusan.includes(d)} onChange={(e) => setForm((f) => {
                        const arr = new Set(f.dimensiLulusan);
                        if (e.target.checked) arr.add(d); else arr.delete(d);
                        return { ...f, dimensiLulusan: Array.from(arr) };
                      })} />{d}
                    </label>
                  ))}
                </div>
              </div>

              <div className="flex gap-2">
                <button type="submit" className="flex-1 py-2 bg-green-600 text-white rounded">Generate RPM</button>
                <button type="button" onClick={() => { setForm(initialForm); setGenerated(null); }} className="py-2 px-3 border rounded">Reset</button>
              </div>
            </form>
          </section>

          <section className="md:col-span-2 bg-white p-4 rounded shadow space-y-4">
            <div className="flex items-center justify-between">
              <h2 className="font-semibold">Hasil / Pratinjau Rencana Pembelajaran Mendalam (RPM)</h2>
              <div className="flex gap-2">
                <button onClick={handleCopyAndOpenDocs} className="px-3 py-1 border rounded">Salin & Buka di Google Dokumen</button>
                <button onClick={handlePrintPdf} className="px-3 py-1 border rounded">Cetak PDF</button>
              </div>
            </div>

            {!generated && <div className="text-sm text-gray-600">Klik "Generate RPM" pada form untuk membuat rencana pembelajaran.</div>}

            {generated && (
              <div ref={outputRef} className="overflow-auto p-4 border rounded bg-white" style={{ textAlign: "justify" }}>
                {/* IDENTITAS */}
                <div className="mb-4">
                  <h3 className="font-bold mb-2 text-lg">1. Identitas</h3>
                  <table className="w-full table-auto border-collapse text-sm">
                    <tbody>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Nama Satuan Pendidikan</td>
                        <td className="border px-2 py-1">{generated.identitas.namaSatuan}</td>
                        <td className="border px-2 py-1 font-medium">Mata Pelajaran</td>
                        <td className="border px-2 py-1">{generated.identitas.mataPelajaran}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Kelas / Semester</td>
                        <td className="border px-2 py-1">{generated.identitas.kelasSemester}</td>
                        <td className="border px-2 py-1 font-medium">Durasi Pertemuan</td>
                        <td className="border px-2 py-1">{generated.identitas.durasiPertemuan}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                {/* IDENTIFIKASI */}
                <div className="mb-4">
                  <h3 className="font-bold mb-2 text-lg">2. Identifikasi</h3>
                  <table className="w-full table-auto border-collapse text-sm">
                    <tbody>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Siswa</td>
                        <td className="border px-2 py-1">{generated.identifikasi.siswa}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Materi Pelajaran</td>
                        <td className="border px-2 py-1">{generated.identifikasi.materiPelajaran}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Capaian Dimensi Lulusan</td>
                        <td className="border px-2 py-1">{generated.identifikasi.capaianDimensiLulusan}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                {/* DESAIN PEMBELAJARAN */}
                <div className="mb-4">
                  <h3 className="font-bold mb-2 text-lg">3. Desain Pembelajaran</h3>
                  <table className="w-full table-auto border-collapse text-sm">
                    <tbody>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Capaian Pembelajaran</td>
                        <td className="border px-2 py-1">{generated.desain.capaianPembelajaran}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Lintas Disiplin Ilmu</td>
                        <td className="border px-2 py-1">{generated.desain.lintasDisiplin}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Tujuan Pembelajaran</td>
                        <td className="border px-2 py-1">{generated.desain.tujuanPembelajaran}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Topik Pembelajaran</td>
                        <td className="border px-2 py-1">{generated.desain.topikPembelajaran}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Praktik Pedagogis per Pertemuan</td>
                        <td className="border px-2 py-1">
                          <ol className="pl-4 list-decimal">
                            {generated.desain.praktikPerPertemuan.map((p, i) => <li key={i}>{`Pertemuan ${i+1}: ${p}`}</li>)}
                          </ol>
                        </td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Kemitraan Pembelajaran</td>
                        <td className="border px-2 py-1">{generated.desain.kemitraan}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Lingkungan Pembelajaran</td>
                        <td className="border px-2 py-1">{generated.desain.lingkungan}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Pemanfaatan Digital</td>
                        <td className="border px-2 py-1">{generated.desain.pemanfaatanDigital}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                {/* PENGALAMAN BELAJAR */}
                <div className="mb-4">
                  <h3 className="font-bold mb-2 text-lg">4. Pengalaman Belajar</h3>
                  <table className="w-full table-auto border-collapse text-sm">
                    <thead>
                      <tr>
                        <th className="border px-2 py-1">Pertemuan</th>
                        <th className="border px-2 py-1">Memahami</th>
                        <th className="border px-2 py-1">Mengaplikasi</th>
                        <th className="border px-2 py-1">Refleksi</th>
                      </tr>
                    </thead>
                    <tbody>
                      {generated.pengalamanBelajar.map((pb) => (
                        <tr key={pb.pertemuan}>
                          <td className="border px-2 py-1 text-center">{pb.pertemuan}</td>
                          <td className="border px-2 py-1">{pb.memahami}</td>
                          <td className="border px-2 py-1">{pb.mengaplikasi}</td>
                          <td className="border px-2 py-1">{pb.refleksi}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                {/* ASESMEN PEMBELAJARAN */}
                <div className="mb-4">
                  <h3 className="font-bold mb-2 text-lg">5. Asesmen Pembelajaran</h3>
                  <table className="w-full table-auto border-collapse text-sm">
                    <tbody>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Asesmen Awal (diagnostik/apersepsi)</td>
                        <td className="border px-2 py-1">{generated.asesmen.asesmenAwal}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Asesmen Proses</td>
                        <td className="border px-2 py-1">{generated.asesmen.asesmenProses}</td>
                      </tr>
                      <tr>
                        <td className="border px-2 py-1 font-medium">Asesmen Akhir</td>
                        <td className="border px-2 py-1">{generated.asesmen.asesmenAkhir}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                {/* Footer: kepala sekolah & guru di pojok kiri/kanan bawah */}
                <div className="relative mt-6" style={{ minHeight: 80 }}>
                  <div style={{ position: "absolute", left: 0, bottom: 0, textAlign: "left" }}>
                    <div>{form.namaKepala}</div>
                    <div className="text-xs">NIP. {form.nipKepala}</div>
                  </div>
                  <div style={{ position: "absolute", right: 0, bottom: 0, textAlign: "right" }}>
                    <div>{form.namaGuru}</div>
                    <div className="text-xs">NIP. {form.nipGuru}</div>
                  </div>
                </div>

              </div>
            )}

            {/* If admin show token management */}
            {user.role === "admin" && (
              <div className="mt-4 border-t pt-4">
                <h3 className="font-semibold">Panel Admin — Manajemen Token Peserta</h3>
                <div className="flex gap-2 mt-2">
                  <button onClick={() => { const item = makeToken(prompt("Label token (misal: Ujian, Rapat):") || "peserta"); alert(`Token dibuat: ${item.token}`); }} className="px-3 py-1 bg-blue-600 text-white rounded">Buat Token Baru</button>
                  <button onClick={() => { navigator.clipboard.writeText(JSON.stringify(tokens, null, 2)); alert("Daftar token disalin ke clipboard."); }} className="px-3 py-1 border rounded">Salin Daftar Token</button>
                </div>

                <div className="mt-3">
                  <table className="w-full text-sm table-auto border-collapse">
                    <thead>
                      <tr>
                        <th className="border px-2 py-1">Token</th>
                        <th className="border px-2 py-1">Label</th>
                        <th className="border px-2 py-1">Dibuat</th>
                        <th className="border px-2 py-1">Aksi</th>
                      </tr>
                    </thead>
                    <tbody>
                      {tokens.map((t) => (
                        <tr key={t.token}>
                          <td className="border px-2 py-1 font-mono">{t.token}</td>
                          <td className="border px-2 py-1">{t.label}</td>
                          <td className="border px-2 py-1">{new Date(t.createdAt).toLocaleString()}</td>
                          <td className="border px-2 py-1"><button onClick={() => { if (confirm("Revoke token ini?")) revokeToken(t.token); }} className="px-2 py-1 border rounded">Revoke</button></td>
                        </tr>
                      ))}
                      {tokens.length === 0 && <tr><td colSpan={4} className="p-2 text-center text-gray-500">Belum ada token.</td></tr>}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

          </section>
        </main>

      </div>
    </div>
  );
}

// --- Small subcomponents ---
function Input({ label, value, onChange, type = "text", required = false }) {
  return (
    <div>
      <label className="block text-sm font-medium">{label}{required && <span className="text-red-600"> *</span>}</label>
      <input type={type} value={value} onChange={(e) => onChange(e.target.value)} className="w-full p-2 border rounded mt-1" />
    </div>
  );
}

function Textarea({ label, value, onChange, required = false }) {
  return (
    <div>
      <label className="block text-sm font-medium">{label}{required && <span className="text-red-600"> *</span>}</label>
      <textarea value={value} onChange={(e) => onChange(e.target.value)} rows={3} className="w-full p-2 border rounded mt-1" />
    </div>
  );
}

function AdminLoginForm({ onLogin }) {
  const [u, setU] = useState("");
  const [p, setP] = useState("");
  return (
    <form onSubmit={(e) => { e.preventDefault(); onLogin(u.trim(), p.trim()); }} className="space-y-2">
      <div>
        <input placeholder="Username admin" value={u} onChange={(e) => setU(e.target.value)} className="w-full p-2 border rounded" />
      </div>
      <div>
        <input placeholder="Password admin" value={p} onChange={(e) => setP(e.target.value)} type="password" className="w-full p-2 border rounded" />
      </div>
      <div className="flex gap-2">
        <button type="submit" className="px-3 py-1 bg-indigo-600 text-white rounded">Masuk</button>
      </div>
    </form>
  );
}
